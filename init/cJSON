#
# cJSON
#

git checkout cJSON.c
cat cJSON.c | sed  -e"s/return NAN/return (double)NAN/" > t1
mv t1 cJSON.c
if [[ "$1" == "osx" || "$1" == "Darwin" ]]; then
    archisArm="-DCMAKE_APPLE_SILICON_PROCESSOR=arm64"
fi

cmake -DBUILD_SHARED_LIBS=OFF -DCMAKE_INSTALL_LIBDIR=lib -DCMAKE_C_FLAGS=-fPIC ${archisArm} .
make

